id: yellow_taxi_2020_rowcount
namespace: zoomcamp
description: |
  Count total rows across all Yellow Taxi CSVs in 2020 (excluding headers).

tasks:
  - id: count_rows_2020
    type: io.kestra.plugin.scripts.shell.Commands
    taskRunner:
      type: io.kestra.plugin.core.runner.Process
    commands:
      - |
        total=0
        for m in 01 02 03 04 05 06 07 08 09 10 11 12; do
          file="yellow_tripdata_2020-${m}.csv.gz"
          url="https://github.com/DataTalksClub/nyc-tlc-data/releases/download/yellow/${file}"
          rows=$(wget -qO- "$url" | gunzip | tail -n +2 | wc -l)
          echo "month=${m} rows=${rows}"
          total=$((total + rows))
        done
        echo "total_rows_2020=${total}"
